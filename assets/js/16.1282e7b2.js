(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{347:function(a,s,e){"use strict";e.r(s);var t=e(8),r=Object(t.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"docker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker"}},[a._v("#")]),a._v(" Docker")]),a._v(" "),s("p",[a._v("Docker从1.13版本之后采用时间线的方式作为版本号，分为社区版CE和企业版EE。")]),a._v(" "),s("p",[a._v("社区版是免费提供给个人开发者和小型团体使用的，企业版会提供额外的收费服务，比如经过官方测试认证过的基础设施、容器、插件等。")]),a._v(" "),s("p",[a._v("社区版按照stable和edge两种方式发布，每个季度更新stable版本，如17.06，17.09；每个月份更新edge版本，如17.09，17.10。")]),a._v(" "),s("h1",{attrs:{id:"一、安装docker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、安装docker"}},[a._v("#")]),a._v(" 一、安装docker")]),a._v(" "),s("p",[a._v("1、Docker 要求 CentOS 系统的内核版本高于 3.10 ，查看本页面的前提条件来验证你的CentOS 版本是否支持 Docker 。")]),a._v(" "),s("p",[a._v("通过 "),s("strong",[a._v("uname -r")]),a._v(" 命令查看你当前的内核版本")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("uname")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v("\n")])])]),s("p",[a._v("2、使用 "),s("code",[a._v("root")]),a._v(" 权限登录 Centos。确保 yum 包更新到最新。")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("yum update\n")])])]),s("p",[a._v("3、卸载旧版本(如果安装过旧版本的话)")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("yum remove "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v("  docker-common docker-selinux docker-engine\n")])])]),s("p",[a._v("4、安装需要的软件包， yum-util 提供yum-config-manager功能，另外两个是devicemapper驱动依赖的")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("yum "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v(" yum-utils device-mapper-persistent-data lvm2\n")])])]),s("p",[a._v("5、设置yum源")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n")])])]),s("p",[s("img",{attrs:{src:"/img/docker/1107037-20180128094640209-1433322312.png",alt:"img"}})]),a._v(" "),s("p",[a._v("更新yum缓存")]),a._v(" "),s("p"),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("yum makecache fast\n")])])]),s("p",[a._v("6、可以查看所有仓库中所有docker版本，并选择特定版本安装")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("yum list docker-ce "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--showduplicates")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sort")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v("\n")])])]),s("p",[s("img",{attrs:{src:"/img/docker/1107037-20180128095038600-772177322.png",alt:"img"}})]),a._v(" "),s("p",[a._v("7、安装docker")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("yum "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" docker-ce  "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#由于repo中默认只开启stable仓库，故这里安装的是最新稳定版17.12.0")]),a._v("\nyum "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("FQPN"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 例如：sudo yum install docker-ce-17.12.0.ce")]),a._v("\n")])])]),s("p",[s("img",{attrs:{src:"/img/docker/1107037-20180128103448287-493824081.png",alt:"img"}})]),a._v(" "),s("p",[a._v("8、启动并加入开机启动")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("systemctl start "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v("\nsystemctl "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("enable")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v("\n")])])]),s("p",[a._v("9、验证安装是否成功(有client和service两部分表示docker安装启动都成功了)")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" version\n")])])]),s("p",[s("img",{attrs:{src:"/img/docker/1107037-20180128104046600-1053107877.png",alt:"img"}})]),a._v(" "),s("h1",{attrs:{id:"二、问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、问题"}},[a._v("#")]),a._v(" 二、问题")]),a._v(" "),s("p",[a._v("1、因为之前已经安装过旧版本的docker，在安装的时候报错如下：")]),a._v(" "),s("div",{staticClass:"language-tex extra-class"},[s("pre",{pre:!0,attrs:{class:"language-tex"}},[s("code",[a._v("Transaction check error:\n  file /usr/bin/docker from install of docker-ce-17.12.0.ce-1.el7.centos.x86_64 conflicts with file from package docker-common-2:1.12.6-68.gitec8512b.el7.centos.x86_64\n  file /usr/bin/docker-containerd from install of docker-ce-17.12.0.ce-1.el7.centos.x86_64 conflicts with file from package docker-common-2:1.12.6-68.gitec8512b.el7.centos.x86_64\n  file /usr/bin/docker-containerd-shim from install of docker-ce-17.12.0.ce-1.el7.centos.x86_64 conflicts with file from package docker-common-2:1.12.6-68.gitec8512b.el7.centos.x86_64\n  file /usr/bin/dockerd from install of docker-ce-17.12.0.ce-1.el7.centos.x86_64 conflicts with file from package docker-common-2:1.12.6-68.gitec8512b.el7.centos.x86_64\n")])])]),s("p",[a._v("2、卸载旧版本的包")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("yum erase docker-common-2:1.12.6-68.gitec8512b.el7.centos.x86_64\n")])])]),s("p",[s("img",{attrs:{src:"/img/docker/1107037-20180128103145287-536100760.png",alt:"img"}})]),a._v(" "),s("p",[a._v("3、再次安装docker")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("yum "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" docker-ce\n")])])]),s("p",[a._v("https://www.cnblogs.com/yufeng218/p/8370670.html")]),a._v(" "),s("h1",{attrs:{id:"三、设置阿里云镜像加速和日志配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、设置阿里云镜像加速和日志配置"}},[a._v("#")]),a._v(" 三、设置阿里云镜像加速和日志配置")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" /etc/docker\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tee")]),a._v(" /etc/docker/daemon.json "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<-")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('\'EOF\'\n{\n  "registry-mirrors": ["https://8dqfgjuq.mirror.aliyuncs.com"],\n  "log-driver":"json-file",\n  "log-opts": {"max-size":"100m", "max-file":"50"}\n}\nEOF')]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl daemon-reload\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl restart "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v("\n")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);